{% extends "base.html" %}

{% block title %}Clubs{% endblock %}

{% block content %}
<div class="container my-4">
    <h3 class="mb-2">All Clubs</h3>
    <p class="text-muted mb-4">
        Explore detailed profiles of every club including their focus, notable achievements,
        founding year, and current member strength. Use the search and category filter to
        quickly find clubs that match your interests.
    </p>

    <div class="row mb-3">
        <div class="col-md-6">
            <div class="input-group">
                <span class="input-group-text">
                    <span class="visually-hidden">Search</span>
                    ðŸ”Ž
                </span>
                <input type="text" class="form-control" id="searchInput" placeholder="Search clubs...">
            </div>
        </div>
        <div class="col-md-6">
            <select class="form-select" id="categoryFilter">
                <option value="">All Categories</option>
                <option value="Academic">Academic</option>
                <option value="Technical">Technical</option>
                <option value="Cultural">Cultural</option>
                <option value="Sports">Sports</option>
            </select>
        </div>
    </div>

    <div class="row" id="clubsGrid">
        {% for club in clubs %}
        <div class="col-lg-6 mb-3 club-card" data-category="{{ club.category }}">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <div class="d-flex w-100 justify-content-between mb-2">
                        <h5 class="mb-0">{{ club.name }}</h5>
                        <span class="badge bg-secondary align-self-start">{{ club.category }}</span>
                    </div>
                    <p class="mb-0 fs-5" style="line-height: 1.8;">{{ club.description }}</p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="row" id="noResults" style="display: none;">
        <div class="col-12">
            <div class="alert alert-info">No clubs found. Adjust your search.</div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const clubsGrid = document.getElementById('clubsGrid');
    const noResults = document.getElementById('noResults');
    const clubCards = document.querySelectorAll('.club-card');

    function filterClubs() {
        const searchTerm = (searchInput.value || '').toLowerCase();
        const selectedCategory = categoryFilter.value;
        let visibleCount = 0;

        clubCards.forEach(card => {
            const name = card.querySelector('h5').textContent.toLowerCase();
            const desc = card.querySelector('p').textContent.toLowerCase();
            const clubCategory = card.dataset.category;
            const matchesSearch = name.includes(searchTerm) || desc.includes(searchTerm);
            const matchesCategory = !selectedCategory || clubCategory === selectedCategory;

            if (matchesSearch && matchesCategory) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        noResults.style.display = visibleCount === 0 ? '' : 'none';
        clubsGrid.style.display = visibleCount === 0 ? 'none' : '';
    }

    searchInput.addEventListener('input', filterClubs);
    categoryFilter.addEventListener('change', filterClubs);
});
</script>
{% endblock %}
